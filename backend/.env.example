# GitClaw Backend Configuration

# Database connection URL (required)
# Note: Default PostgreSQL port is 5432, but local dev may use different ports
# Special characters in password must be URL-encoded (e.g., $ = %24)
DATABASE_URL=postgres://gitclaw:gitclaw@localhost:5432/gitclaw

# Maximum database connections in pool
DATABASE_MAX_CONNECTIONS=10

# Server configuration
HOST=127.0.0.1
PORT=8080

# Signature validation
SIGNATURE_EXPIRY_SECS=300

# Idempotency TTL in hours
IDEMPOTENCY_TTL_HOURS=24

# Logging level
RUST_LOG=gitclaw=debug,actix_web=info

# =============================================================================
# S3 Object Storage Configuration
# =============================================================================
# GitClaw supports S3-compatible object storage for Git objects.
# This enables scalable storage using AWS S3, MinIO, Cloudflare R2, or other
# S3-compatible providers.

# S3 bucket name (required when using S3 storage)
# Must be 3-63 characters, lowercase, DNS-compatible
# S3_BUCKET=gitclaw-objects

# Custom S3 endpoint URL (optional)
# Required for MinIO, Cloudflare R2, or other S3-compatible providers
# For AWS S3, leave unset to use the default endpoint
# S3_ENDPOINT=http://localhost:9000

# AWS region (optional, defaults to "us-east-1")
# S3_REGION=us-east-1

# Static credentials (optional)
# If not set, uses AWS default credential chain (IAM roles, env vars, etc.)
# S3_ACCESS_KEY_ID=your-access-key
# S3_SECRET_ACCESS_KEY=your-secret-key

# Use path-style addressing (optional, defaults to false)
# Set to "true" for MinIO and some S3-compatible providers
# When true: http://endpoint/bucket/key
# When false: http://bucket.endpoint/key (virtual-hosted style)
# S3_USE_PATH_STYLE=false

# Auto-create bucket if it doesn't exist (optional, defaults to false)
# S3_AUTO_CREATE_BUCKET=false

# Maximum retry attempts for S3 operations (optional, defaults to 3)
# S3_MAX_RETRIES=3

# Maximum backoff in seconds for retry operations (optional, defaults to 30)
# S3_RETRY_MAX_BACKOFF=30

# =============================================================================
# MinIO Local Development Setup
# =============================================================================
# To run MinIO locally for development:
#
# 1. Start MinIO with Docker:
#    docker run -d --name minio \
#      -p 9000:9000 -p 9001:9001 \
#      -e MINIO_ROOT_USER=minioadmin \
#      -e MINIO_ROOT_PASSWORD=minioadmin \
#      minio/minio server /data --console-address ":9001"
#
# 2. Access MinIO Console at http://localhost:9001
#    Username: minioadmin
#    Password: minioadmin
#
# 3. Create a bucket named "gitclaw-objects" in the console
#
# 4. Configure environment variables:
#    S3_ENDPOINT=http://localhost:9000
#    S3_BUCKET=gitclaw-objects
#    S3_REGION=us-east-1
#    S3_ACCESS_KEY_ID=minioadmin
#    S3_SECRET_ACCESS_KEY=minioadmin
#    S3_USE_PATH_STYLE=true
#    S3_AUTO_CREATE_BUCKET=true
#
# =============================================================================
# AWS S3 Production Setup
# =============================================================================
# For AWS S3 in production:
#
# 1. Create an S3 bucket in your AWS account
#
# 2. Configure IAM credentials with appropriate permissions:
#    - s3:GetObject
#    - s3:PutObject
#    - s3:DeleteObject
#    - s3:ListBucket
#    - s3:GetBucketLocation
#
# 3. Configure environment variables:
#    S3_BUCKET=your-bucket-name
#    S3_REGION=your-region
#    # For EC2/ECS with IAM roles, credentials are automatic
#    # For other environments, set static credentials:
#    # S3_ACCESS_KEY_ID=your-access-key
#    # S3_SECRET_ACCESS_KEY=your-secret-key
#
# =============================================================================
# Cloudflare R2 Setup
# =============================================================================
# For Cloudflare R2:
#
# 1. Create an R2 bucket in your Cloudflare account
#
# 2. Generate API tokens with R2 permissions
#
# 3. Configure environment variables:
#    S3_ENDPOINT=https://<account-id>.r2.cloudflarestorage.com
#    S3_BUCKET=your-bucket-name
#    S3_REGION=auto
#    S3_ACCESS_KEY_ID=your-r2-access-key
#    S3_SECRET_ACCESS_KEY=your-r2-secret-key
#    S3_USE_PATH_STYLE=true

